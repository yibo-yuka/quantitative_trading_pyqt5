# 日k回測(使用MACD)

這是一個介面，可以控制想要回測的台指期日期範圍，以日為單位進行MACD計算以及每日的OSC，
再使用背離、背離止損策略，進行回測。

## 檔案介紹
1. TX_day_k_ui.py 是日k回測的UI檔案。
2. vm_hour_k.py 是在GCP上的VM跑的期貨交易明細整理成小時K的程式。
3. TX_hour_k_ui.py 是小時k回測的UI檔案。

## 介面設計
1. 使用PyQt5套件，設計可以控制回測範圍、回測本金、策略使用、並即時顯示報表在UI上。
2. 最右側有一個報表列表，可以點擊後開啟新的分頁在UI上，並顯示對應報表。
3. 如果想要存取特定幾個報表成一個Excel活頁簿，可以使用匯出報表功能。

## 日K程式碼(資料處理過程)
1. 依照使用者指定回測的時間範圍，會上FinMind抓取[指定開始時間前三個月]~[指定結束時間後三個月(沒有的話就選當前最晚時間)]的日K資料。
2. 只擷取近月資料，結算日判斷近月的方式：日盤算當月結算日，夜盤算下個月結算日。
3. 計算MACD OSC，之後用以跟k棒比較，判斷背離。
4. 得到背離訊號後，下一根k棒進場(做多或做空)，最後會顯示在訊號交易紀錄上。
5. 所有平倉的動作會結算做多與做空的報酬率，為買賣交易紀錄。
6. 完成一次回測會多一筆損益歷史紀錄，會實時顯示在UI上。
7. 最終提供的報表：新的損益歷史紀錄、訊號交易紀錄、買賣交易紀錄、總表。
8. 匯出報表時，選擇的每一個報表為一個Excel worksheet，並且可以決定要存在哪裡、檔名。

## 備註
1.目前尚未包裝成exe檔
2.icon請注意路徑
